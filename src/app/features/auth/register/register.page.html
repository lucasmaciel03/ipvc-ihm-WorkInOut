<ion-content class="register-content">
  <!-- Bot√£o para voltar que estava faltando -->
  <div class="back-button">
    <ion-button fill="clear" routerLink="/auth/welcome" color="light">
      <ion-icon name="arrow-back-outline" slot="icon-only"></ion-icon>
    </ion-button>
  </div>

  <!-- Indicador de progresso -->
  <div class="progress-indicator">
    <div class="step" [class.active]="currentStep >= 1" (click)="goToStep(1)">
      1
    </div>
    <div class="step-line" [class.active]="currentStep >= 2"></div>
    <div class="step" [class.active]="currentStep >= 2" (click)="goToStep(2)">
      2
    </div>
    <div class="step-line" [class.active]="currentStep >= 3"></div>
    <div class="step" [class.active]="currentStep >= 3" (click)="goToStep(3)">
      3
    </div>
  </div>

  <div class="register-container" [class.step-3]="currentStep === 3">
    <!-- Etapa 1: Dados Pessoais (estilizado como a imagem) -->
    <div *ngIf="currentStep === 1">
      <div class="register-header">
        <h1>BEM-VINDO <span class="emoji">üëã</span></h1>
        <p>Pronto para uma nova jornada?<span class="emoji">üî•</span></p>
      </div>

      <form [formGroup]="registerForm">
        <div class="input-container">
          <div class="input-wrapper icon-start">
            <ion-icon name="person-outline"></ion-icon>
            <ion-input
              type="text"
              formControlName="name"
              placeholder="O teu nome"
              autocomplete="name"
            ></ion-input>
          </div>
        </div>

        <div class="input-container">
          <div class="input-wrapper icon-start">
            <ion-icon name="mail-outline"></ion-icon>
            <ion-input
              type="email"
              formControlName="email"
              placeholder="O teu email"
              autocomplete="email"
            ></ion-input>
          </div>
        </div>

        <div class="input-container">
          <div class="input-wrapper icon-start">
            <ion-icon name="lock-closed-outline"></ion-icon>
            <ion-input
              [type]="showPassword ? 'text' : 'password'"
              formControlName="password"
              placeholder="A tua password"
            ></ion-input>
            <ion-icon
              [name]="showPassword ? 'eye-outline' : 'eye-off-outline'"
              class="toggle-password"
              (click)="togglePasswordVisibility()"
              tabindex="0"
            ></ion-icon>
          </div>
        </div>

        <div class="input-container">
          <div class="input-wrapper icon-start">
            <ion-icon name="lock-closed-outline"></ion-icon>
            <ion-input
              [type]="showConfirmPassword ? 'text' : 'password'"
              formControlName="confirmPassword"
              placeholder="Confirmar password"
            ></ion-input>
            <ion-icon
              [name]="showConfirmPassword ? 'eye-outline' : 'eye-off-outline'"
              class="toggle-password"
              (click)="toggleConfirmPasswordVisibility()"
              tabindex="0"
            ></ion-icon>
          </div>
        </div>
      </form>
    </div>

    <!-- Etapa 2: Objetivos -->
    <div *ngIf="currentStep === 2">
      <div class="register-header">
        <h1>Quais os<br />Teus objetivos? <span class="emoji">üéØ</span></h1>
      </div>

      <form [formGroup]="registerForm">
        <div class="goals-container">
          <div
            class="goal-card"
            [class.selected]="registerForm.get('primaryGoal')?.value === 'lose_weight'"
            (click)="selectGoal('lose_weight')"
          >
            <div class="goal-content">
              <h3>Perder Peso</h3>
              <p>Queimar Calorias e Tonificar o Corpo</p>
            </div>
            <div class="goal-icon">
              <span class="emoji">üî•</span>
            </div>
          </div>

          <div
            class="goal-card"
            [class.selected]="registerForm.get('primaryGoal')?.value === 'gain_muscle'"
            (click)="selectGoal('gain_muscle')"
          >
            <div class="goal-content">
              <h3>Ganhar M√∫sculo</h3>
              <p>Aumentar massa e for√ßa</p>
            </div>
            <div class="goal-icon">
              <span class="emoji">üèãÔ∏è‚Äç‚ôÇÔ∏è</span>
            </div>
          </div>

          <div
            class="goal-card"
            [class.selected]="registerForm.get('primaryGoal')?.value === 'improve_fitness'"
            (click)="selectGoal('improve_fitness')"
          >
            <div class="goal-content">
              <h3>Ficar em Forma</h3>
              <p>Sentir-se mais saud√°vel</p>
            </div>
            <div class="goal-icon">
              <span class="emoji">üßò</span>
            </div>
          </div>
        </div>

        <!-- Campo oculto para armazenar o valor selecionado -->
        <ion-input type="hidden" formControlName="primaryGoal"></ion-input>
      </form>
    </div>

    <!-- Etapa 3: Condi√ß√£o F√≠sica - Layout vertical -->
    <div *ngIf="currentStep === 3" class="step-3">
      <div class="register-header">
        <h1>Fala-nos sobre ti <span class="emoji">üßç</span></h1>
      </div>

      <form [formGroup]="registerForm">
        <div class="input-container">
          <label>Altura</label>
          <div class="input-wrapper icon-start">
            <ion-icon name="resize-outline"></ion-icon>
            <ion-input
              type="number"
              formControlName="height"
              placeholder="cm"
              inputmode="numeric"
            ></ion-input>
          </div>
        </div>

        <div class="input-container">
          <label>Peso</label>
          <div class="input-wrapper icon-start">
            <ion-icon name="scale-outline"></ion-icon>
            <ion-input
              type="number"
              formControlName="weight"
              placeholder="kg"
              inputmode="numeric"
            ></ion-input>
          </div>
        </div>

        <div class="input-container">
          <label>Idade</label>
          <div class="input-wrapper icon-start">
            <ion-icon name="calendar-outline"></ion-icon>
            <ion-input
              type="number"
              formControlName="age"
              placeholder="Anos"
              inputmode="numeric"
            ></ion-input>
          </div>
        </div>

        <div class="input-container">
          <label>G√©nero</label>
          <div class="select-wrapper">
            <ion-icon
              name="person-circle-outline"
              class="select-start-icon"
            ></ion-icon>
            <ion-select
              formControlName="gender"
              placeholder="Selecionar"
              interface="action-sheet"
            >
              <ion-select-option value="male">Masculino</ion-select-option>
              <ion-select-option value="female">Feminino</ion-select-option>
              <ion-select-option value="other">Outro</ion-select-option>
              <ion-select-option value="prefer_not_to_say"
                >Prefiro n√£o dizer</ion-select-option
              >
            </ion-select>
            <ion-icon
              name="chevron-down-outline"
              class="select-icon"
            ></ion-icon>
          </div>
        </div>
      </form>
    </div>

    <!-- Navega√ß√£o entre etapas -->
    <div class="step-navigation">
      <ion-button
        *ngIf="currentStep > 1"
        fill="outline"
        (click)="previousStep()"
      >
        Anterior
      </ion-button>

      <ion-button
        *ngIf="currentStep < 3"
        (click)="nextStep()"
        expand="block"
        class="next-button"
      >
        Pr√≥ximo
      </ion-button>

      <ion-button
        *ngIf="currentStep === 3"
        (click)="onSubmit()"
        expand="block"
        class="submit-button"
      >
        Criar Conta
      </ion-button>
    </div>
  </div>
</ion-content>
